---
reviewed_on: "2024-11-20"
---

# Regression, interpolation and natural spline

$$
\newcommand \abs[1]{ \left \lvert #1 \right \rvert }
$$

## 1

Para el siguiente conjunto de datos:

| $x$ |  $y$  |
|:---:|:-----:|
| $1$ |  $1$  |
| $2$ | $1.5$ |
| $3$ |  $2$  |
| $4$ |  $3$  |
| $5$ |  $4$  |
| $6$ |  $5$  |
| $7$ |  $8$  |

Calcular el error relativo porcentual encontrado al verificar $f(7) = 8$ con $f(x) = y$ en cada uno de los tres casos.

1. Encuentre el polinomio llevando a cabo regresión lineal.

    $$
    y = a_0 + a_1 x
    $$

    $$
    n = 7 \\[10 pt]

    \sum_{ i = 0 }^n x_i = 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28 \\[10 pt]

    \sum_{ i = 0 }^n y_i = 1 + 1.5 + 2 + 3 + 4 + 5 + 8 = 24.5 \\[10 pt]

    \sum_{ i = 0 }^n { x_i y_i } = 1 * 1 + 2 * 1.5 + 3 * 2 + 4 * 3 + 5 * 4 + 6 * 5 + 7 * 8 = 128 \\[10 pt]

    \sum_{ i = 0 }^n { x_i }^2 = 1 + 4 + 9 + 16 + 25 + 36 + 49 = 140 \\[10 pt]
    $$

    $$
    \begin{array}{lcl}
        a_0 & =       & \frac{ n \sum_{ i = 0 }^n { x_i y_i } - \sum_{ i = 0 }^n x_i \sum_{ i = 0 }^n y_i }{ n \sum_{ i = 0 }^n { x_i }^2 - (\sum_{ i = 0 }^n x_i)^2 } \\[10 pt]
            & =       & \frac{ 7 * 128 - 28 * 24.5 }{ 7 * 140 - 28^2 } \\[10 pt]
            & =       & \frac{ 210 }{ 196 } \\[10 pt]
            & \approx & 1.0714
    \end{array}
    $$

    $$
    \begin{array}{lcl}
        a_0 & = & \frac{ \sum_{ i = 0 }^n y_i - a_1 \sum_{ i = 0 }^n x_i }{ n } \\[10 pt]
            & \approx & \frac{ 24.5 - 1.0714 * 28 }{ 7 } \\[10 pt]
            & \approx & \frac{ -5.5 }{ 7 } \\[10 pt]
            & \approx & -0.7857
    \end{array}
    $$

    $$
    y = -0.7857 + 1.0714 x
    $$

    $$
    f(7) = -0.7857 + 1.0714 (7) \approx 6.7143 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 8 - 6.7143 }{ 8 } } * 100\% \approx 16.07\%
    $$

2. Encuentre el polinomio llevando a cabo Interpolación de Newton.

    $$
    \begin{array}{c|c|c|c|c|c|c|c}
        x & y   & \nabla^1 & \nabla^2 & \nabla^3            & \nabla^4  & \nabla^5 & \nabla^6 \\
        \hline \\
        1 & 1   & 0.5      &  0       &  0.08\overline{ 3 } & -0.0417   & 0.0125   &  0 \\
        2 & 1.5 & 0.5      &  0.25    & -0.08\overline{ 3 } &  0.0208   & 0.0125 \\
        3 & 2   & 1        &  0       & 0                   &  0.08\overline{ 3 } \\
        4 & 3   & 1        &  0       & 0.\overline{ 3 } \\
        5 & 4   & 1        &  1 \\
        6 & 5   & 3 \\
        7 & 8 \\
    \end{array}
    $$

    $$
    \begin{align*}
        c_0 & = y_0 = 1 \\
        c_1 & = \delta_0 = 0.5 \\
        c_2 & = { \delta^{ (2) } }_0 = 0 \\
        c_3 & = { \delta^{ (3) } }_0 = 0.08\overline{ 3 } \\
        c_4 & = { \delta^{ (4) } }_0 = -0.0417 \\
        c_5 & = { \delta^{ (5) } }_0 = 0.0125 \\
        c_6 & = { \delta^{ (6) } }_0 = 0 \\
    \end{align*}
    $$

    $$
    \begin{align*}
        P(x) & = 1 + 0.5 (x - 1) + 0 (x - 1) (x - 2) \\
             & \quad + 0.084 (x - 1) (x - 2) (x - 3) \\
             & \quad - 0.0417 (x - 1) (x - 2) (x - 3) (x - 4) \\
             & \quad + 0.0125 (x - 1) (x - 2) (x - 3) (x - 4) (x - 5)
    \end{align*}
    $$

    $$
    P(7) = 8.068 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 8 - 8.068 }{ 8 } } * 100\% = 0.0085\%
    $$

3. Encuentre el polinomio llevando a cabo interpolación de Lagrange.

    $$
    P_n(x)= \sum_{ i = 0 }^n { y_i \prod_{ \underset{ j \neq i }{ j = 0 } }^n \frac{ x - x_j }{ x_i - x_j } }
    $$

    $$
    \begin{array}{lcl}
        L_0(x) & = & \frac{ (x - 2) (x - 3) (x - 4) (x - 5) (x - 6) (x - 7) }{ (1 - 2) (1 - 3) (1 - 4) (1 - 5) (1 - 6) (1 - 7) } = \frac{ (x - 2) (x - 3) (x - 4) (x - 5) (x - 6) (x - 7) }{ 720 } \\[10 pt]
        L_1(x) & = & \frac{ (x - 1) (x - 3) (x - 4) (x - 5) (x - 6) (x - 7) }{ (2 - 1) (2 - 3) (2 - 4) (2 - 5) (2 - 6) (2 - 7) } = -\frac{ (x - 1) (x - 3) (x - 4) (x - 5) (x - 6) (x - 7) }{ 120 } \\[10 pt]
        L_2(x) & = & \frac{ (x - 1) (x - 2) (x - 4) (x - 5) (x - 6) (x - 7) }{ (3 - 1) (3 - 2) (3 - 4) (3 - 5) (3 - 6) (3 - 7) } = \frac{ (x - 1) (x - 2) (x - 4) (x - 5) (x - 6) (x - 7) }{ 48 } \\[10 pt]
        L_3(x) & = & \frac{ (x - 1) (x - 2) (x - 3) (x - 5) (x - 6) (x - 7) }{ (4 - 1) (4 - 2) (4 - 3) (4 - 5) (4 - 6) (4 - 7) } = -\frac{ (x - 1) (x - 2) (x - 3) (x - 5) (x - 6) (x - 7) }{ 36 } \\[10 pt]
        L_4(x) & = & \frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 6) (x - 7) }{ (5 - 1) (5 - 2) (5 - 3) (5 - 4) (5 - 6) (5 - 7) } = \frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 6) (x - 7) }{ 48 } \\[10 pt]
        L_5(x) & = & \frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 5) (x - 7) }{ (6 - 1) (6 - 2) (6 - 3) (6 - 4) (6 - 5) (6 - 7) } = -\frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 5) (x - 7) }{ 120 } \\[10 pt]
        L_6(x) & = & \frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 5) (x - 6) }{ (7 - 1) (7 - 2) (7 - 3) (7 - 4) (7 - 5) (7 - 6) } = \frac{ (x - 1) (x - 2) (x - 3) (x - 4) (x - 5) (x - 6) }{ 720 }
    \end{array}
    $$

    $$
    P(x) = y_0 L_0(x) + y_1 L_1(x) + y_2 L_2(x) + y_3 L_3(x) + y_4 L_4(x) + y_5 L_5(x) + y_6 L_6 \\[10 pt]

    P(x) \approx 0.0125 x^5 - 0.2292 x^4 + 1.5625 x^3 - 4.7708 x^2 + 6.9271 x - 2.5
    $$

    $$
    P(7) = 8 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 8 - 8 }{ 8 } } * 100\% = 0\%
    $$

## 2

Para el siguiente conjunto de datos:

|  $x$   |  $y$  |
|:------:|:-----:|
| $2.5$  | $13$  |
| $3.5$  | $11$  |
|  $5$   | $8.5$ |
|  $6$   | $8.2$ |
| $7.5$  |  $7$  |
|  $10$  | $6.2$ |
| $12.5$ | $5.2$ |

Calcular el error relativo porcentual encontrado al verificar $f(12.5) = 5.2$ con $f(x) = y$ en cada uno de los tres casos.

1. Encuentre el polinomio llevando a cabo regresión lineal.

    $$
    y = a_0 + a_1 x
    $$

    $$
    n = 7 \\[10 pt]

    \sum_{ i = 0 }^{ n } x_i = 2.5 + 3.5 + 5 + 6 + 7.5 + 10 + 12.5 = 47 \\[10 pt]

    \sum_{ i = 0 }^{ n } y_i = 13 + 11 + 8.5 + 8.2 + 7 + 6.2 + 5.2 = 59.1 \\[10 pt]

    \sum_{ i = 0 }^{ n } x_i y_i = 2.5 * 13 + 3.5 * 11 + 5 * 8.5 + 6 * 8.2 + 7.5 * 7 + 10 * 6.2 + 12.5 * 5.2 = 342.2 \\[10 pt]

    \sum_{ i = 0 }^{ n } x_i^2 = (2.5)^2 + (3.5)^2 + 5^2 + 6^2 + (7.5)^2 + 10^2 + (12.5)^2 = 392 \\[10 pt]
    $$

    $$
    \begin{align*}
        a_1 & = \frac{ n \sum_{ i = 0 }^n x_i y_i - \sum_{ i = 0 }^n x_i \sum_{ i = 0 }^n y_i }{ n \sum_{ i = 0 }^n x_i^2 - ( \sum_{ i = 0 }^n x_i )^2 } \\[10 pt]
            & = \frac{ 7 * 342.2 - 47 * 59.1 }{ 7 * 392 - 47^2 } \\[10 pt]
            & = \frac{ 2395.4 - 2777.7 }{ 2744 - 2209 } \\[10 pt]
            & = \frac{ -382.3 }{ 535 } \\[10 pt]
            & \approx -0.7146
    \end{align*}
    $$

    $$
    \begin{align*}
    a_0 &= \frac{ \sum_{ i = 0 }^n y_i - a_1 \sum_{ i = 0 }^n x_i }{ n } \\[10 pt]
        &= \frac{ 59.1 - ( -0.7146 ) \times 47 }{ 7 } \\[10 pt]
        &= \frac{ 59.1 + 33.7862 }{ 7 } \\[10 pt]
        &= \frac{ 92.8862 }{ 7 } \\[10 pt]
        &\approx 13.2695
    \end{align*}
    $$

    $$
    y = 13.2695 - 0.7146 x
    $$

    $$
    f(12.5) = 13.2695 - 0.7146 \times 12.5 \approx 4.337 \\[10 pt]

    \text{error relativo porcentual} = \abs{ \frac{ 5.2 - 4.337 }{ 5.2 } } \times 100\% \approx 16.6\%
    $$

2. Encuentre el polinomio llevando a cabo Interpolación de Newton.

    $$
    \begin{array}{c|c|c|c|c|c|c|c}
        x    & y   & \nabla^1 & \nabla^2 & \nabla^3 & \nabla^4 & \nabla^5 & \nabla^6 \\
        \hline \\
        2.5  & 13  & -2    & 0.133 & 0.118  & -0.061 & 0.013 & -0.0019 \\
        3.5  & 11  & -1.67 & 0.547 & -0.1867 & 0.038 & -0.005 \\
        5    & 8.5 & -0.3  & -0.2  & 0.064   & -0.01 \\
        6    & 8.2 & -0.8  & 0.12  & -0.0209 \\
        7.5  & 7   & -0.32 & -0.016 \\
        10   & 6.2 & -0.4 \\
        12.5 & 5.2 \\
    \end{array}
    $$

    $$
    \begin{align*}
        c_0 & = y_0 = 13 \\
        c_1 & = \delta_0 = -2 \\
        c_2 & = { \delta^{ (2) } }_0 = 0.133 \\
        c_3 & = { \delta^{ (3) } }_0 = 0.118 \\
        c_4 & = { \delta^{ (4) } }_0 = -0.061 \\
        c_5 & = { \delta^{ (5) } }_0 = 0.013 \\
        c_6 & = { \delta^{ (6) } }_0 = -0.0019 \\
    \end{align*}
    $$

    $$
    \begin{align*}
        P(x) & = 13 - 2 (x - 2.5) + 0.133 (x - 2.5) (x - 3.5) + 0.118 (x - 2.5) (x - 3.5) (x - 5) \\
             & \quad - 0.061 (x - 2.5) (x - 3.5) (x - 5) (x - 6) \\
             & \quad + 0.013 (x - 2.5) (x - 3.5) (x - 5) (x - 6) (x - 7.5) \\
             & \quad - 0.0019 (x - 2.5) (x - 3.5) (x - 5) (x - 6) (x - 7.5) (x - 10)
    \end{align*}
    $$

    $$
    P(12.5) = 5.1 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 5.2 - 5.1 }{ 5.2 } } * 100\% \approx 1.9\%
    $$

3. Encuentre el polinomio llevando a cabo interpolación de Lagrange.

    $$
    P(x) = \sum_{ i = 0 }^{ 6 } { y_i L_i(x) }
    $$

    Dado que $x = 12.5$ es uno de los puntos de datos ($x_6 = 12.5$), entonces $L_6(12.5) = 1$ y $L_i(12.5) = 0$ para $i \ne 6$.

    Por lo tanto:

    $$
    P(12.5) = y_6 L_6(12.5) = 5.2 * 1 = 5.2
    $$

    $$
    \text{ error relativo porcentual } = \abs{ \frac{ 5.2 - 5.2 }{ 5.2 } } * 100\% = 0\%
    $$

## 3

Para el siguiente conjunto de datos:

| $x$  |  $y$  |
|:----:|:-----:|
| $3$  | $1.6$ |
| $4$  | $3.6$ |
| $5$  | $4.4$ |
| $7$  | $3.4$ |
| $8$  | $2.2$ |
| $9$  | $2.8$ |
| $11$ | $3.8$ |
| $12$ | $4.6$ |

Calcular el error relativo porcentual encontrado al verificar $f(12) = 4.6$ con $f(x) = y$ en cada uno de los tres casos.

1. Encuentre el polinomio llevando a cabo regresión lineal.

    $$
    y = a_0 + a_1 x
    $$

    $$
    n = 8 \\[10 pt]

    \sum_{ i = 1 }^{ n } x_i = 3 + 4 + 5 + 7 + 8 + 9 + 11 + 12 = 59 \\[10 pt]

    \sum_{ i = 1 }^{ n } y_i = 1.6 + 3.6 + 4.4 + 3.4 + 2.2 + 2.8 + 3.8 + 4.6 = 26.4 \\[10 pt]

    \sum_{ i = 1 }^{ n } x_i y_i = 3 * 1.6 + 4 * 3.6 + 5 * 4.4 + 7 * 3.4 + 8 * 2.2 + 9 * 2.8 + 11 * 3.8 + 12 * 4.6 = 204.8 \\[10 pt]

    \sum_{ i = 1 }^{ n } x_i^2 = 3^2 + 4^2 + 5^2 + 7^2 + 8^2 + 9^2 + { 11 }^2 + { 12 }^2 = 509
    $$

    $$
    \begin{align*}
        a_1 & = \frac{ n \sum_{ i = 0 }^n x_i y_i - \sum_{ i = 0 }^n x_i \sum_{ i = 0 }^n y_i }{ n \sum_{ i = 0 }^n x_i^2 - (\sum_{ i = 0 }^n x_i)^2 } \\[10 pt]
            & = \frac{ 8 * 204.8 - 59 * 26.4 }{ 8 * 509 - (59)^2 } \\[10 pt]
            & = \frac{ 1638.4 - 1557.6 }{ 4072 - 3481 } \\[10 pt]
            & = \frac{ 80.8 }{ 591 } \\[10 pt]
            & \approx 0.1367
    \end{align*}
    $$

    $$
    \begin{align*}
        a_0 & = \frac{ \sum_{ i = 0 }^n y_i - a_1 \sum_{ i = 0 }^n x_i }{ n } \\[10 pt]
            & = \frac{ 26.4 - 0.1367 \times 59 }{ 8 } \\[10 pt]
            & = \frac{ 26.4 - 8.0653 }{ 8 } \\[10 pt]
            & = \frac{ 18.3347 }{ 8 } \\[10 pt]
            & \approx 2.2918
    \end{align*}
    $$

    $$
    y = 2.2918 + 0.1367 x
    $$

    $$
    f(12) = 2.2918 + 0.1367 * 12 \approx 3.9322 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 4.6 - 3.9322 }{ 4.6 } } * 100\% \approx 14.5\%
    $$

2. Encuentre el polinomio llevando a cabo Interpolación de Newton.

    $$
    \begin{array}{c|c|c|c|c|c|c|c|c}
        x  & y   & \nabla^1 & \nabla^2 & \nabla^3 & \nabla^4 & \nabla^5 & \nabla^6 & \nabla^7 \\
        \hline \\
        3  & 1.6 & 2        & -0.6     & 0.042    & 0.00167  & 0.0075   & -0.0033 & 0.0009077 \\
        4  & 3.6 & 0.8      & -0.44    & 0.05     & 0.0467   & -0.01896 & 0.00486 \\
        5  & 4.4 & -0.5     & -0.24    & 0.284    & -0.0862  & 0.01992 \\
        7  & 3.4 & -1.2     & 0.9      & -0.24    & 0.0534\\
        8  & 2.2 & 0.6      & -0.034   & 0.034 \\
        9  & 2.8 & 0.5      & 0.1 \\
        11 & 3.8 & 0.8 \\
        12 & 4.6
    \end{array}
    $$

    $$
    \begin{align*}
        c_0 & = y_0 = 1.6 \\
        c_1 & = \delta_0 = 2 \\
        c_2 & = { \delta^{ (2) } }_0 = -0.6 \\
        c_3 & = { \delta^{ (3) } }_0 = 0.042 \\
        c_4 & = { \delta^{ (4) } }_0 = 0.00167 \\
        c_5 & = { \delta^{ (5) } }_0 = 0.0075 \\
        c_6 & = { \delta^{ (6) } }_0 = -0.0033 \\
        c_7 & = { \delta^{ (7) } }_0 = 0.0009077
    \end{align*}
    $$

    $$
    \begin{align*}
        P(x) & = 1.6 + 2 (x - 1.6) - 0.6 (x - 1.6) (x - 3.6) + 0.042 (x - 1.6) (x - 3.6) (x - 4.4) \\
             & \quad + 0.00167 (x - 1.6) (x - 3.6) (x - 4.4) (x - 3.4) \\
             & \quad + 0.0075 (x - 1.6) (x - 3.6) (x - 4.4) (x - 3.4) (x - 2.2) \\
             & \quad - 0.0033 (x - 1.6) (x - 3.6) (x - 4.4) (x - 3.4) (x - 2.2) (x - 2.8) \\
             & \quad + 0.0009077 (x - 1.6) (x - 3.6) (x - 4.4) (x - 3.4) (x - 2.2) (x - 2.8) (x - 3.8)
    \end{align*}
    $$

    $$
    P(12) = 4.848 \\[10 pt]

    \text{ error relativo porcentual } = \abs{ \frac{ 4.6 - }{ 4.6 } } * 100\% \approx 1.9\%
    $$

3. Encuentre el polinomio llevando a cabo interpolación de Lagrange.

    $$
    P(x) = \sum_{ i = 0 }^{ 6 } { y_i L_i(x) }
    $$

    Dado que $x = 12$ es uno de los puntos de datos ($x_7 = 12$), entonces $L_7(12) = 1$ y $L_i(12) = 0$ para $i \ne 7$.

    Por lo tanto:

    $$
    P(12) = y_6 L_6(12) = 4.6 * 1 = 4.6
    $$

    $$
    \text{ error relativo porcentual } = \abs{ \frac{ 4.6 - 4.6 }{ 4.6 } } * 100\% = 0\%
    $$

## 9

Use funciones de spline cúbico para generar la curva que pasa por los siguientes datos:

| $x$ |  $y$  |
|:---:|:-----:|
| $0$ |  $1$  |
| $1$ | $1.5$ |
| $2$ | $1.6$ |
| $3$ | $1.5$ |
| $4$ | $0.9$ |
| $5$ | $2.2$ |
| $6$ | $2.8$ |
| $7$ | $3.1$ |

$$
S(x) =
    \begin{cases}
        { S_0 }(x) = a_0 + b_0 x + c_0 x^2 + d_0 x^3 & x \in [0, 1) \\
        { S_1 }(x) = a_1 + b_1 x + c_1 x^2 + d_1 x^3 & x \in [1, 2) \\
        \vdots \\
        { S_7 }(x) = a_6 + b_6 x + c_6 x^2 + d_6 x^3 & x \in [6, 7]
    \end{cases}
$$

### Ecuaciones de interpolacion

1. ${ S_0 }(0) = 1$.

    $$
    a_0 = 1
    $$

2. ${ S_1 }(1)$.

    $$
    a_1 + b_1 + c_1 + d_1 = 1.5
    $$

3. ${ S_2 }(2)$.

    $$
    a_2 + 2 b_2 + 4 c_2 + 8 d_2 = 1.6
    $$

4. ${ S_3 }(3)$.

    $$
    a_3 + 3 b_3 + 9 c_3 + 27 d_3 = 1.5
    $$

5. ${ S_4 }(4)$.

    $$
    a_4 + 4 b_4 + 16 c_4 + 64 d_4 = 0.9
    $$

6. ${ S_5 }(5)$.

    $$
    a_5 + 5 b_5 + 25 c_4 + 125 d_5 = 2.2
    $$

7. ${ S_6 }(6)$.

    $$
    a_6 + 6 b_5 + 36 c_6 + 216 d_6 = 2.8
    $$

8. ${ S_7 }(7)$.

    $$
    a_6 + 7 b_6 + 49 c_6 + 343 d_6 = 3.1
    $$

### Ecuaciones de continuidad (9)

1. ${ S_0 }(1) = { S_1 }(1)$.

    $$
    a_0 + b_0 + c_0 + d_0 = a_1 + b_1 + c_1 + d_1 \\[10 pt]

    a_0 + b_0 + c_0 + d_0 - a_1 - b_1 - c_1 - d_1 = 0
    $$

2. ${ S_1 }(2) = { S_2 }(2)$.

    $$
    a_1 + 2 b_1 + 4 c_1 + 8 d_1 = a_2 + 2 b_2 + 4 c_2 + 8 d_2 \\[10 pt]

    a_1 + 2 b_1 + 4 c_1 + 8 d_1 - a_2 - 2 b_2 - 4 c_2 - 8 d_2 = 0
    $$

3. ${ S_2 }(3) = { S_3 }(3)$.

    $$
    a_2 + 3 b_2 + 9 c_2 + 27 d_2 = a_3 + 3 b_3 + 9 c_3 + 27 d_3 \\[10 pt]

    a_2 + 3 b_2 + 9 c_2 + 27 d_2 - a_3 - 3 b_3 - 9 c_3 - 27 d_3 = 0
    $$

4. ${ S_3 }(4) = { S_4 }(4)$.

    $$
    a_3 + 4 b_3 + 16 c_3 + 64 d_3 = a_4 + 4 b_4 + 16 c_4 + 64 d_4 \\[10 pt]

    a_3 + 4 b_3 + 16 c_3 + 64 d_3 - a_4 - 4 b_4 - 16 c_4 - 64 d_4 = 0
    $$

5. ${ S_4 }(5) = { S_5 }(5)$.

    $$
    a_4 + 5 b_4 + 25 c_4 + 125 d_4 = a_5 + 5 b_5 + 25 c_5 + 125 d_5 \\[10 pt]

    a_4 + 5 b_4 + 25 c_4 + 125 d_4 - a_5 - 5 b_5 - 25 c_5 - 125 d_5 = 0
    $$

6. ${ S_5 }(6) = { S_6 }(6)$.

    $$
    a_5 + 6 b_5 + 36 c_5 + 216 d_5 = a_6 + 6 b_6 + 36 c_6 + 216 d_6 \\[10 pt]

    a_5 + 6 b_5 + 36 c_5 + 216 d_5 - a_6 - 6 b_6 - 36 c_6 - 216 d_6 = 0
    $$

### Ecuaciones de continuidad 1er derivada (9)

1. ${ { S_0 }' }(1) = { { S_1 }' }(1)$.

    $$
    b_0 + 2 c_0 + 3 d_0 = b_1 + 2 c_1 + 3 d_1 \\[10 pt]

    b_0 + 2 c_0 + 3 d_0 - b_1 - 2 c_1 - 3 d_1 = 0
    $$

2. ${ { S_1 }' }(2) = { { S_2 }' }(2)$.

    $$
    b_1 + 4 c_1 + 12 d_1 = b_2 + 4 c_2 + 12 d_2 \\[10 pt]

    b_1 + 4 c_1 + 12 d_1 - b_2 - 4 c_2 - 12 d_2 = 0
    $$

3. ${ { S_2 }' }(3) = { { S_3 }' }(3)$.

    $$
    b_2 + 6 c_2 + 27 d_2 = b_3 + 6 c_3 + 27 d_3 \\[10 pt]

    b_2 + 6 c_2 + 27 d_2 - b_3 - 6 c_3 - 27 d_3 = 0
    $$

4. ${ { S_3 }' }(4) = { { S_4 }' }(4)$.

    $$
    b_3 + 8 c_3 + 48 d_3 = b_4 + 8 c_4 + 48 d_4 \\[10 pt]

    b_3 + 8 c_3 + 48 d_3 - b_4 - 8 c_4 - 48 d_4 = 0
    $$

5. ${ { S_4 }' }(5) = { { S_5 }' }(5)$.

    $$
    b_4 + 10 c_4 + 75 d_4 = b_5 + 10 c_5 + 75 d_5 \\[10 pt]

    b_4 + 10 c_4 + 75 d_4 - b_5 - 10 c_5 - 75 d_5 = 0
    $$

6. ${ { S_5 }' }(6) = { { S_6 }' }(5)$.

    $$
    b_5 + 12 c_5 + 108 d_5 = b_6 + 12 c_6 + 108 d_6 \\[10 pt]

    b_5 + 12 c_5 + 108 d_5 - b_6 - 12 c_6 - 108 d_6  = 0
    $$

### Ecuaciones de continuidad 2da derivada (9)

1. ${ { S_0 }'' }(1) = { { S_1 }'' }(1)$.

    $$
    2 c_0 + 6 d_0 = 2 c_1 + 6 d_1 \\[10 pt]

    2 c_0 + 6 d_0 - 2 c_1 - 6 d_1 = 0
    $$

2. ${ { S_1 }'' }(2) = { { S_2 }'' }(2)$.

    $$
    2 c_1 + 12 d_1 = 2 c_2 + 12 d_2 \\[10 pt]

    2 c_1 + 12 - 2 c_2 - 12 d_2 = 0
    $$

3. ${ { S_2 }'' }(3) = { { S_3 }'' }(3)$.

    $$
    2 c_2 + 18 d_2 = 2 c_3 + 18 d_3 \\[10 pt]

    2 c_2 + 18 d_2 - 2 c_3 - 18 d_3 = 0
    $$

4. ${ { S_3 }'' }(4) = { { S_4 }'' }(4)$.

    $$
    2 c_3 + 24 d_3 = 2 c_4 + 24 d_4 \\[10 pt]

    2 c_3 + 24 d_3 - 2 c_4 - 24 d_4 = 0
    $$

5. ${ { S_4 }'' }(5) = { { S_5 }'' }(5)$.

    $$
    2 c_4 + 30 d_4 = 2 c_5 + 30 d_5 \\[10 pt]

    2 c_4 + 30 d_4 - 2 c_5 - 30 d_5 = 0
    $$

6. ${ { S_5 }'' }(6) = { { S_6 }'' }(5)$.

    $$
    2 c_5 + 36 d_5 = 2 c_6 + 36 d_6 \\[10 pt]

    2 c_5 + 36 d_5 - 2 c_6 - 36 d_6  = 0
    $$

### Condicion de frontera (9)

1. $S''(0) = 0$.

    $$
    2 c_0 = 0
    $$

2. $S''(7) = 0$.

    $$
    2 c_5 + 42 d_5 = 0
    $$

$$
\begin{bmatrix}
    1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 2 & 4 & 8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 3 & 9 & 27 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 4 & 16 & 64 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 5 & 25 & 125 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 6 & 36 & 216 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 7 & 49 & 343 \\
    1 & 1 & 1 & 1 & -1 & -1 & -1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 1 & 2 & 4 & 8 & -1 & -2 & -4 & -8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 3 & 9 & 27 & -1 & -3 & -9 & -27 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 4 & 16 & 64 & -1 & -4 & -16 & -64 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 5 & 25 & 125 & -1 & -5 & -25 & -125 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 6 & 36 & 216 & -1 & -6 & -36 & -216 \\
    0 & 1 & 2 & 3 & 0 & -1 & -2 & -3 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 1 & 4 & 12 & 0 & -1 & -4 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 6 & 27 & 0 & -1 & -6 & -27 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 12 & 108 & 0 & -1 & -12 & -108 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 10 & 75 & 0 & -1 & -10 & -75 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 12 & 108 & 0 & -1 & -12 & -108 \\
    0 & 0 & 2 & 6 & 0 & 0 & -2 & -6 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 2 & 12 & 0 & 0 & -2 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 18 & 0 & 0 & -2 & -18 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 24 & 0 & 0 & -2 & -24 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 30 & 0 & 0 & -2 & -30 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 36 & 0 & 0 & -2 & -36 \\
    0 & 0 & 2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 42 \\
\end{bmatrix}
\begin{bmatrix}
    a_0 \\
    b_0 \\
    c_0 \\
    d_0 \\
    a_1 \\
    b_1 \\
    c_1 \\
    d_1 \\
    a_2 \\
    b_2 \\
    c_2 \\
    d_2 \\
    a_3 \\
    b_3 \\
    c_3 \\
    d_3 \\
    a_4 \\
    b_4 \\
    c_4 \\
    d_4 \\
    a_5 \\
    b_5 \\
    c_5 \\
    d_5 \\
    a_6 \\
    b_6 \\
    c_6 \\
    d_6 \\
\end{bmatrix}
=
\begin{bmatrix}
    1 \\
    1.5 \\
    1.6 \\
    1.5 \\
    0.9 \\
    2.2 \\
    2.8 \\
    3.1 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0 \\
    0
\end{bmatrix}
$$

## 10

Determine los parámetros $a$, $b$, $c$, $d$ y $e$ tal que $S$ sea un spline natural cúbico.

$$
S(x) =
    \begin{cases}
        a + b (x - 1) + c (x - 1)^2 + d (x - 1)^3 & x \in [0,1) \\
        (x - 1)^3 + e x^2 - 1 & x \in [1, 2]
    \end{cases}
$$

$$
a + b (x - 1) + c (x - 1)^2 + d(x - 1)^3 = a + b x - b + c x^2 - 2 c x + c + d x^3 - 3 d x^2  + 3 x d - d \\[10 pt]

(x - 1)^3 + e x^2 - 1 = x^3 - 3 x^2 + 3 x + e x^2 - 2
$$

### Ecuaciones de continuidad (10)

$$
{ S_0 }(1) = { S_1 }(1) \\[10 pt]

a = e - 1
$$

### Ecuaciones de continuidad 1er derivada (10)

$$
{ { S_0 }' }(1) = { { S_1 }' }(1) \\[10 pt]

{ { S_0 }' }(x) = b + 2 c x - 2 c + 3 d x^2 - 6 d x + 3 d \\[10 pt]

{ { S_1 }' }(x) = 3 x^2 - 6 x + 3 + 2 e x \\[10 pt]

b + 2 c - 2 c + 3 d - 6 d + 3 d = 3 - 6 + 3 + 2 e \\[10 pt]

b = 2 e
$$

### Ecuaciones de continuidad 2da derivada (10)

$$
{ { S_0 }'' }(1) = { { S_1 }'' }(1) \\[10 pt]

{ { S_0 }'' }(x) = 2 c + 6 d x - 6 d \\[10 pt]

{ { S_1 }'' }(x) = 6 x - 6 + 2 e \\[10 pt]

2 c + 6 d - 6 d = 6 - 6 + 2 e \\[10 pt]

2 c = 2 e
$$

### Condicion de frontera (10)

1. $S''(0) = 0$.

    $$
    2 c - 6 d = 0
    $$

2. $S''(2) = 0$.

    $$
    12 - 6 + 2 e = 0 \\[10 pt]

    e = -3
    $$

$$
e = -3 \quad c = -3 \quad b = -6 \quad a = -4 \quad d = -1
$$

$$
S(x) =
    \begin{cases}
        -4 - 6 (x - 1) - 3 (x - 1)^2 - (x - 1)^3 & x \in [0,1) \\
        (x - 1)^3 - 3 x^2 - 1 & x \in [1, 2]
    \end{cases}
$$
